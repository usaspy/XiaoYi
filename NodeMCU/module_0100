/*
module0100 环境监测模块
功能：定时将传感器数据通过UDP传送给中心端，中心端下发指令给模块
DHT22 温湿度传感器
MP-503 空气质量传感器
*/
#include <DHT.h>
#include <DHT_U.h>
#include <ESP8266WiFi.h>
#include <WiFiUDP.h>
#include <ESP8266Ping.h>

//WIFI配置
const String SSID = "HUAWEI";
const String PASSWORD = "123456";

//中心UDP服务器配置
const String host = "LULU";
const unsigned int remoteUDPPort = 9527;

//其他配置
int onoff = 0;  //0:停用（默认不发送传感器数据）  1：启用
unsigned long interval = 300;  //udp上报时间间隔，默认300秒  0 ~ 4294967295

//DHT22传感器连接nodeMCU的针脚
const int DHT22_PIN = D2;

//MP503传感器连接nodeMCU的针脚
const int MP503_A_PIN = D0;
const int MP503_B_PIN = D1;

#define DHTTYPE DHT22
DHT dht(DHT22_PIN, DHTTYPE);
WiFiUDP UDP;

void setup() {
  Serial.begin(9600);
  pinMode(LED_BUILTIN,OUTPUT);
  delay(3000);  //等待3秒
  Serial.print("connecting to WIFI...");
  Serial.println(SSID);

  WiFi.mode(WIFI_STA);
  WiFi.begin(SSID,PASSWORD);

  while(WiFi.status() != WL_CONNECTED){
     delay(1000);
     Serial.println("connecting...");
  }

  Serial.println("WiFi connected!");
  Serial.print("Device IP:");
  Serial.print(WiFi.localIP());

  if(Ping.ping(host.c_str())){
    Serial.println("ping success");
  }else{
    Serial.println("ping failed");
  }
}

void loop() {

}